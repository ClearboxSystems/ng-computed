/*! ng-computed 0.0.5 */!function(){"use strict";angular.module("ngComputed",["ng"]);var a=function(a,b){var c=function(a){return function(){a.selectAll("line.edge").attr({x1:function(a){return a.source.x},y1:function(a){return a.source.y},x2:function(a){return a.target.x},y2:function(a){return a.target.y}}),a.selectAll("g.node").attr("transform",function(a){return"translate("+a.x+","+a.y+")"})}},d=function(a,b,c,d){var e=a.layout.force().charge(-300).gravity(.1).distance(50).size([c,d]);return e.on("tick",b),e},e=function(a,b){var c=a.append("g");return c.append("defs").call(function(a){a.append("marker").attr("id","arrowhead"+b).attr("viewBox","0 -5 10 10").attr("refX",15).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").call(function(a){a.append("path").attr("d","M0,-5L10,0L0,5")})}),c},f=function(a){var b={};for(var c in a){var d=c.substr(0,c.lastIndexOf("#"));b[d]=!0;for(var e in a[c]){var f=e.substr(0,e.lastIndexOf("|"));b[f]=!0}}return b},g=function(a,b){var c=[];for(var d in a){var e=d.substr(0,d.lastIndexOf("#"));for(var f in a[d]){var g=f.substr(0,f.lastIndexOf("|"));c.push({source:b.indexOf(g),target:b.indexOf(e)})}}return c},h=function(a,b){var c=f(a),d=Object.keys(c),e=g(a,d),h=d.map(function(a){var d=b[a]||{};return c[a]={id:a,name:a,x:d.x,y:d.y,fixed:d.fixed},c[a]});return{nodes:c,nodeList:h,edges:e}},i=function(a){var b={};for(var c in a){var d={};for(var e in a[c])d[e]=!0;b[c]=d}return b},j=0;return function(f,g,k){var l=++j,m=k.width,n=k.height,o=f.behavior.zoom().on("zoom",function(){var a=f.event.translate,b=f.event.scale;r.attr("transform","translate("+a+") scale("+b+")")}),p=f.select(g).attr({width:m,height:n}),q=p.append("rect").attr({fill:"#FFF",width:m,height:n}).call(o),r=e(p,l),s=c(r),t=d(f,s,k.width,k.height),u=f.behavior.drag().on("dragstart",function(){t.stop()}).on("drag",function(a){a.px+=f.event.dx,a.py+=f.event.dy,a.x+=f.event.dx,a.y+=f.event.dy,a.fixed=!0,s()}).on("dragend",function(){t.resume()}),v=null,w={},x=a.$watch(function(){var a=i(b.dependencyGraph());if(!angular.equals(v,a)){v=angular.copy(a);var c=h(b.dependencyGraph(),w);w=c.nodes;var d=r.selectAll("line.edge").data(c.edges);d.enter().append("line").attr({"class":"edge","marker-end":"url(#arrowhead"+l+")"}).style({stroke:"rgb(200, 200, 200)","stroke-width":"1.5px",fill:"none"}),d.exit().remove();var e=r.selectAll("g.node").data(c.nodeList,function(a){return a.id});e.enter().append("g").attr({"class":"node"}).on("mouseover",function(){f.select(this).select("text").style({display:"block"})}).on("mouseout",function(a){a.displayLabel||f.select(this).select("text").style({display:"none"})}).call(function(a){a.append("text").style({display:"none"}).attr({dx:5,dy:5}).text(function(a){return a.name}),a.append("circle").attr({r:5}).style({fill:"#aaa"})}).call(u),e.exit().remove(),t.nodes(c.nodeList).links(c.edges).start()}});return x.resize=function(a,b){p.style({width:a,height:b}),q.attr({width:a,height:b}),t.size([a,b])},x}};angular.module("ngComputed").factory("$batchedWatch",["$rootScope","$parse","$exceptionHandler",function(a,b,c){var d=a.$watch,e=1,f=function(a,b,f,g){var h=a[f],i=h[b];i||(i={fns:{},deregister:d.call(this,b,function(a,b,d){var e=this;angular.forEach(i.fns,function(f){try{f.run.call(e,a,f.hasRun?b:a,d),f.hasRun=!0}catch(g){c(g)}})},f)},h[b]=i);var j=e++;return i.fns[j]={run:g,hasRun:!1},j},g=function(a){for(var b in a)return!1;return!0},h=function(a,b,c,d){var e=a[c];if(e[b]){var f=e[b],h=f.fns;delete h[d],g(h)&&(f.deregister(),delete a[c][b])}},i=function(a,c,e){var g=this;if(e=!!e,angular.isFunction(a))return d.call(this,a,c,e);if(!angular.isFunction(c)){var i=b(c);c=function(a,b,c){i(c)}}var j;j=this.hasOwnProperty("$$batchedWatchers")?this.$$batchedWatchers:{"true":{},"false":{}};var k=f.call(g,j,a,e,c),l=function(){h.call(g,j,a,e,k)};return this.$$batchedWatchers=j,l};return i}]),angular.module("ngComputed").provider("$computed",[function(){var b=["$q",function(a){return function(b,c){a.when(b).then(c,c)}}],c=!1;this.provideExtractor=function(a){b=a},this.useDebug=function(a){c=a},this.$get=["$injector","$parse","$trackedEval","$log","$exceptionHandler","$rootScope",function(d,e,f,g,h,i){var j=d.invoke(b),k={},l=function(a,b,c,d){var e={};return angular.forEach(a,function(a,c){c in b?(e[c]=a,d&&(k[d][c]=a.scope.$eval(a.expr))):(a.deregister(),d&&k[d]&&delete k[d][c])}),angular.forEach(b,function(b,f){if(f in a);else{var g=function(){c()};switch(e[f]=b,b.type){case"equal":case"reference":b.deregister=b.scope.$watch(b.expr,g,"equal"==b.type);break;case"collection":b.deregister=b.scope.$watchCollection(b.expr,g);break;default:console.error("Unknown watch type: ",b.type," Not tracking dependency on: ",b.expr)}d&&(k[d][f]=b.scope.$eval(b.expr))}}),e},m=function(a,b,c,d,e){var g=c,i={};e&&(k[e]={});var m=0,n=function(){m++},o=function(){var c=f.trackDependencies.call(a,b,g);void 0===c.thrown?j(c.value,d):(j(void 0,d),h(c.thrown)),i=l(i,c.dependencies,n,e)},p=a.$watch(function(){return m},o),q=function(){angular.isFunction(b.destroy)&&b.destroy(),l(i,{},null,e),p(),e&&delete k[e]};return q.setArgs=function(a){angular.equals(g,a)||(g=angular.copy(a),o())},q},n=function(a,b,c,d,e,f){if(b.length-d==1)return m(a,b[d],e,function(a){c(a)},f&&f+"#"+d);var g=null,h=m(a,b[d],e,function(e){null===g?g=n(a,b,c,d+1,[e],f):g.setArgs([e])},f&&f+"#"+d),i=function(){g&&g(),h()};return i.setArgs=function(a){h.setArgs(a)},i},o=function(a,b){var d=this,f=e(a).assign,g=angular.isArray(b)?b:[b],h=n(d,g,function(a){f(d,a)},0,[],c?this.$id+"|"+a:null),i=this.$on("$destroy",function(){h()});return function(){i(),h()}};return o.dependencyGraph=function(){return c?k:null},o.drawDependencies=a(i,o),o}]}])}(window,document),angular.module("ngComputed").provider("$trackedEval",[function(){var a="equal";this.setDefaultWatchType=function(b){a=b},this.$get=["$parse",function(b){var c=null,d=function(a,b){var d=c;c={};try{return{value:a.apply(this,b),dependencies:c}}catch(e){return{thrown:e,dependencies:c}}finally{c=d}},e=function(a,d,e){if(c){if(angular.isFunction(a))throw new Error("Function used in $trackedEval while tracking dependencies. Instead, call the function and use $trackedEval internally.");c[this.$id+"|"+a+"|"+d]={scope:this,expr:a,type:d}}return b(a)(this,e)},f=function(a,b){return e.call(this,a,"equal",b)},g=function(a,b){return e.call(this,a,"reference",b)},h=function(a,b){return e.call(this,a,"collection",b)},i=function(a){a.$evalEqual=f,a.$evalReference=g,a.$evalCollection=h,a.trackDependencies=d,Object.defineProperty(a,"trackDependencies",{enumerable:!1})};if(i(f),i(g),i(h),"equal"==a)return f;if("reference"==a)return g;if("collection"==a)return h;throw new Error("Cannot create watch of default type '"+a+"': unknown type")}]}]);